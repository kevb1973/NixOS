#!/bin/bash

apps=(
    "launch - Zen:zen"
    "launch - Helix:kitty hx"
    "launch - Spotify:spotify --no-zygote"
    "sn - search nixpkgs:kitty --detach --hold --app-id floater fish -c sn"
    "no - search options:kitty --detach --app-id floater fish -c no"
    "aichat:kitty aichat -m llama-cpp:gemma3-4b -r concise -s session --empty-session"
    "ai - kill server:pkill llama-server"
    "ai - Model - Enoch-12b:notify-send -u low 'AI Model' 'Loading Enoch-12b' && pkill llama-server; llama-server -m ~/Code/models/Enoch-CWC-Mistral-Nemo-12B-v2-GGUF-q4_k_m.gguf -a 'Enoch-12b' --ctx-size 8192 --port 8081 --host 127.0.0.1"
    "ai - Model - Gemma3-4b: notify-send -u low 'AI Model' 'Loading Gemma3-4b' && pkill llama-server; llama-server -a 'Gemma3-4b (vision)' -m ~/Code/models/ggml-org_gemma-3-4b-it-GGUF_gemma-3-4b-it-Q4_K_M.gguf --mmproj ~/Code/models/ggml-org_gemma-3-4b-it-GGUF_mmproj-model-f16.gguf --temp 1.0 --top-k 64 --min-p 0.00 --top-p 0.95 --repeat-penalty 1.0 --ctx-size 8192 --port 8081 --host 127.0.0.1"
    "ai - Model - GPT-OSS-20B(reasoning):notify-send -u low 'AI Model' 'Loading GPT-OSS-20B' && pkill llama-server; llama-server -a 'GPT-OSS-20b' -m ~/Code/models/gpt-oss-20b-MXFP4.gguf --jinja --ctx-size 8192 -ub 2048 -b 2048 --n-cpu-moe 21 --temp 1.0 --top-p 1.0 --top-k 0 --min-p 0 --port 8081 --host 127.0.0.1"
    "ai - Model - LFM2-8B-A1B:notify-send -u low 'AI Model' 'Loading LFM2' && pkill llama-server; llama-server -a 'LFM2-8B-A1B' -m ~/Code/models/LFM2-8B-A1B-Q4_K_M.gguf --ctx-size 8192 --temp 0.3 --min-p 0.15 --repeat-penalty 1.05 --port 8081 --host 127.0.0.1"
    "ai - Model - Qwen3-30B-A3B:notify-send -u low 'AI Model' 'Loading Qwen3-30B-A3B' && pkill llama-server; llama-server -a 'Qwen-30b-A3B' -m ~/Code/models/Qwen3-30B-A3B-Instruct-2507-Q4_K_M.gguf --ctx-size 8192 --temp 0.7 --top-p 0.8 --min-p 0 --top-k 20 --presence-penalty 1.05 --port 8081 --host 127.0.0.1"
    "ai - Model - Qwen3-4B-instruct:notify-send -u low 'AI Model' 'Loading Qwen3-4B-Instruct' && pkill llama-server; llama-server -a 'Qwen3-4B-Instruct' -m ~/Code/models/Qwen3-4B-Instruct-2507-IQ4_XS.gguf --ctx-size 8192 --temp 0.7 --top-p 0.8 --top-k 20 --min-p 0 --presence-penalty 1.05 --port 8081 --host 127.0.0.1"
    "config - FZF Launcher:kitty --detach  hx ~/NixOS/home/dots/bin/launch"
    "config - Fish - aliases/abbrs:kitty hx ~/NixOS/home/dots/fish/conf.d/aliases-abbrs.fish"
    "config - Fish - config:kitty hx ~/NixOS/home/dots/fish/config.fish"
    "config - Helix - config:kitty hx ~/.config/helix/config.toml"
    "config - Helix - languages:kitty hx ~/.config/helix/languages.toml"
    "config - Kitty:kitty hx ~/.config/kitty/kitty.conf"
    "config - Mango - binds:kitty hx ~/.config/mango/binds.conf"
    "config - Mango - config:kitty hx ~/.config/mango/config.conf"
    "config - Mango - layout(scroll):kitty hx ~/.config/mango/layouts/scroll.conf"
    "config - Mango - rules:kitty hx ~/.config/mango/rules.conf"
    "config - Niri - binds: kitty hx ~/.config/niri/binds.kdl"
    "config - Niri - main: kitty hx ~/.config/niri/config.kdl"
    "config - Niri - edit open-float.py: kitty hx ~/NixOS/home/dots/bin/niri-open-float.py"
    "config - Niri - environment: kitty hx ~/.config/niri/environment.kdl"
    "config - Niri - input: kitty hx ~/.config/niri/input.kdl"
    "config - Niri - layer-rules: kitty hx ~/.config/niri/layer-rules.kdl"
    "config - Niri - layout: kitty hx ~/.config/niri/layout.kdl"
    "config - Niri - output: kitty hx ~/.config/niri/output.kdl"
    "config - Niri - restart open-float.py:pkill python3; niri-open-float"
    "config - Niri - spawns: kitty hx ~/.config/niri/spawns.kdl"
    "config - Niri - wiki: kitty --app-id floater tv niri-wiki"
    "config - Niri - window-rules: kitty hx ~/.config/niri/window-rules.kdl"
    "config - NixOS - environment:kitty hx ~/NixOS/modules/environment.nix"
    "config - NixOS - flake:kitty hx ~/NixOS/flake.nix"
    "config - NixOS - home:kitty hx ~/NixOS/home/home.nix"
    "config - NixOS - programs:kitty hx ~/NixOS/modules/programs.nix"
    "config - NixOS - services:kitty hx ~/NixOS/modules/services.nix"
    "config - NixOS - users:kitty hx ~/NixOS/modules/users.nix"
    "config - Yazi - main:kitty hx ~/.config/yazi/yazi.toml"
    "config - Yazi - keymaps:kitty hx ~/.config/yazi/keymap.toml"
    "DMS - restart:systemctl --user restart dms"
    "DMS - settings:dms ipc settings toggle"
    "DMS - start:systemctl --user start dms"
    "DMS - stop:systemctl --user stop dms"
    "Helix - bin:kitty hx ~/NixOS/home/dots/bin"
    "Helix - .config:kitty hx ~/.config"
    "Helix - home:kitty hx"
    "Helix - nixos:kitty hx ~/NixOS"
    "Launch - atq manager:kitty --app-id floater tv atq"
    "Launch - btop:kitty btop"
    "Launch - emacs:emacs"
    "Launch - firefox:firefox"
    "Launch - systemctl-tui:kitty systemctl-tui"
    "Launch - tag editor (puddletag):puddletag"
    "Mixer - alsa :kitty alsamixer"
    "Mixer - pipewire (gui):pwvucontrol"
    "Mixer - pipewire (tui):kitty ncpamixer"
    "npr - remove packages:kitty -e fish -c npr"
    "npu - helix:kitty -e nix profile upgrade helix"
    "npu - jjui:kitty -e nix profile upgrade jjui"
    "npu - mango:kitty -e nix profile upgrade mangowc"
    "npu - zen:kitty -e nix profile upgrade zen-browser-flake"
    "nixOS - rebuild:kitty --hold -e nh os switch ~/NixOS"
    "nixOS - update:kitty --hold -e confirm-update-nixos"
    "podman - podman-tui:kitty podman-tui"
    # "podman - restart miniflux:kitty --hold -e podman compose -f /home/kev/Code/podman/miniflux/compose.yml restart"
    "podman - restart silverbullet:kitty -e podman compose -f /home/kev/Code/podman/silverbullet/compose.yml restart"
    "podman - update all servers:kitty update-servers"
    # "podman - update miniflux:kitty /home/kev/Code/podman/miniflux/miniflux-update-restart"
    "podman - update silverbullet:kitty /home/kev/Code/podman/silverbullet/silverbullet-update-restart"
    "repo - dms:kitty  --app-id repo --title=dms -e jjui ~/Code/DankMaterialShell"
    "repo - helix:kitty  --app-id repo --title=helix -e jjui ~/Code/helix"
    "repo - jjui:kitty  --app-id repo --title=jjui -e jjui ~/Code/jjui"
    "repo - mango:kitty  --app-id repo --title=mango -e jjui ~/Code/mangowc"
    "repo - niri:kitty  --app-id repo --title=niri -e jjui ~/Code/niri"
    "repo - NixOS Config:kitty --detach  jjui ~/NixOS"
    "repo - silverbullet:kitty --detach  jjui ~/Documents/silverbullet"
    "shell - bin:kitty --detach --hold -d ~/.local/bin"
    "shell - code:kitty --detach --hold -d ~/Code"
    "shell - config:kitty --detach --hold -d ~/.config"
    "shell - downloads:kitty --detach --hold -d ~/Downloads"
    "shell - home:kitty --detach --hold"
    "shell - nixos:kitty --detach --hold -d ~/NixOS"
    "shell - nixos:kitty --detach --hold -d ~/NixOS"
    "shell - temp:kitty --detach --hold -d ~/Temp"
    "util - check nixpkgs pr merge:kitty --detach --app-id floater fish -c checkpr"
    "util - color picker (hex/rgb):niri-pick-color"
    "util - color picker (hex with zoom):hyprpicker -f hex -a"
    "util - ssh to sam's pc:kitty -e ssh sam@10.0.0.4"
    "util - stopwatch:kitty --app-id panel-unfocused -o font_size=9 clock-rs stopwatch"
    "util - set timer:kitty --detach --app-id panel-focused -o font_size=9 set_timer"
    "util - tv env:kitty --app-id floater tv env"
    "util - kill process:kitty --app-id floater pik"
    "wifi - enable radio:rfkill unblock 1"
    "wifi - disable radio:rfkill block 1"
    "wifi - connect (wpa_gui):wpa_gui"
    "yazi - bin:kitty yazi ~/NixOS/home/dots/bin"
    "yazi - code:kitty yazi ~/Code"
    "yazi - config:kitty yazi ~/.config"
    "yazi - downloads:kitty yazi ~/Downloads"
    "yazi - fish:kitty yazi ~/NixOS/home/dots/fish/"
    "yazi - fish functions:kitty yazi ~/NixOS/home/dots/fish/functions/personal"
    "yazi - home:kitty yazi"
    "yazi - meditation sounds:kitty yazi ~/Music/meditational/best"
    "yazi - nixos:kitty yazi ~/NixOS"
    "yazi - nixpkgs:kitty yazi /etc/nix/inputs/nixpkgs"
    "yazi - nix store:kitty yazi /nix/store/"
    "yazi - silverbullet:kitty yazi ~/Documents/silverbullet"
    "yazi - temp:kitty yazi ~/Temp"
)

choice=$(printf "%s\n" "${apps[@]}" | cut -d: -f1 | fzf -e --cycle --prompt="  ")

if [ -n "$choice" ]; then
    cmd=$(printf "%s\n" "${apps[@]}" | grep "^$choice:" | cut -d: -f2)

    # Executes the app, fully detaching it from the terminal
    setsid sh -c "$cmd >/dev/null 2>&1 &"
fi
